<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据结构 iDoc</title>
    <meta name="description" content="常见的有五种：String（字符串），Hash（哈希），List（列表），Set（集合）、Zset（有序集合）。">
    <meta name="keywords" content="notebook">
    <link rel="stylesheet" type="text/css" href="../css/main.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/tocbot.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/media.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/sidebar.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/copy.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/fancybox.css?v=1.25.0">
    <link rel="icon" href="../logo.png" type="image/x-icon">
    <script src="../js/copy.js?v=1.25.0"></script>
    <script src="../js/dark-mode.js?v=1.25.0"></script>
    <script src="../js/markdown-style.js?v=1.25.0"></script>
    <script src="../js/jquery.min.js?v=1.25.0"></script>
    <script src="../js/fancybox.umd.js?v=1.25.0"></script>
  </head>
  <body><button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
    <script>
// Get the button:
let mybutton = document.getElementById("myBtn");
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};
// 顶部隐藏，底部隐藏
function scrollFunction() {
if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
mybutton.style.display = "block";
} else {
mybutton.style.display = "none";
}
}
// When the user clicks on the button, scroll to the top of the document
function topFunction() {
document.body.scrollTop = 0; // For Safari
document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
</script>
    <header class="header">
      <article class="inner warpper"><a class="logo" href="../index.html"><img alt="iDoc logo" src="../logo.png">
<span class="title">iDoc</span></a>
        <div class="content">
          <ul class="menu">
            <li><a href="../index.html" target="" class="">Home</a></li>
            <li><a href="../00Go/index.html" target="" class="">Go</a></li>
            <li><a href="../01DataStructure/index.html" target="" class="">DataStructure</a></li>
            <li><a href="../01ComputerNetwork/index.html" target="" class="">ComputerNetwrok</a></li>
            <li><a href="index.html" target="" class="active">DataBase</a></li>
            <li><a href="../01OperatingSystem/index.html" target="" class="">OperatingSystem</a></li>
            <li><a href="../03Other/index.html" target="" class="">Other</a></li>
          </ul><a href="https://github.com/shixiaocaia" target="_blank" rel="noopener noreferrer" title="Github" name="Github" class="github"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg></a>
          <dark-mode permanent=""></dark-mode>
        </div>
      </article>
    </header>
    <div class="warpper-content warpper sidebar">
      <div class="sidebar-border">
        <aside class="sidebar" role="navigation">
          <div>
            <a href="index.html" class="">↩️README</a>
            <a href="ch00.html" class="">Hello MySQL</a>
            <a href="ch01.html" class="">SQL</a>
            <a href="ch04.html" class="">写点SQL</a>
            <label>MySQL原理</label>
            <a href="ch02.html" class="">架构</a>
            <label>Redis</label>
            <a href="ch11.html" class="">Hello Redis</a>
          </div>
        </aside>
      </div>
      <markdown-style>
        <h1 id="数据结构"><a aria-hidden="true" tabindex="-1" href="#数据结构" class="anchor"><span class="icon icon-link"></span></a>数据结构</h1>
        <h2 id="关键点"><a aria-hidden="true" tabindex="-1" href="#关键点" class="anchor"><span class="icon icon-link"></span></a>关键点</h2>
        <p>常见的有五种：String（字符串），Hash（哈希），List（列表），Set（集合）、Zset（有序集合）。</p>
        <p>支持了四种数据类型： BitMap（2.2 版新增）、HyperLogLog（2.8 版新增）、GEO（3.2 版新增）、Stream（5.0 版新增）。</p>
        <ul>
          <li>每种数据对象都各自的应用场景，说出它们各自的应用场景</li>
          <li>针对具体的应用场景，使用哪种Redis数据类型来实现</li>
          <li>掌握特性、实现、时间复杂度、各种操作</li>
          <li>超热点：跳表、字典</li>
        </ul>
        <h2 id="对象"><a aria-hidden="true" tabindex="-1" href="#对象" class="anchor"><span class="icon icon-link"></span></a>对象</h2>
        <p>Redis是key-value存储，key和value在Redis中都被抽象为对象，key<strong>只能是String对象</strong>，而Value支持丰富的对象种类。</p>
        <p>Object在内存当中包括：</p>
        <ul>
          <li>type：是哪种Redis)对象</li>
          <li>encoding：表示用哪种底层编码，用OB]ECT ENCODING[key]可以看到对应的编码方式</li>
          <li>lu：记录对象访问信息，用于内存淘汰，这个可以先忽略，后续章节会详细介绍。</li>
          <li>refcount：引用计数，用来描述有多少个指针，指向该对象</li>
          <li>ptr：内容指针，指向实际内容</li>
        </ul>
        <h2 id="string"><a aria-hidden="true" tabindex="-1" href="#string" class="anchor"><span class="icon icon-link"></span></a>String</h2>
        <p>String 是最基本的 key-value 结构，key 是唯一标识，value 是具体的值，value其实不仅是字符串， 也可以是数字（整数或浮点数），value 最多可以容纳的数据长度是 <code>512M</code>。</p>
        <h3 id="适用场景"><a aria-hidden="true" tabindex="-1" href="#适用场景" class="anchor"><span class="icon icon-link"></span></a>适用场景</h3>
        <p>一般用来存字节数据、文本数据、序列化后的对象数据等。</p>
        <h3 id="使用"><a aria-hidden="true" tabindex="-1" href="#使用" class="anchor"><span class="icon icon-link"></span></a>使用</h3>
        <h3 id="编码方式"><a aria-hidden="true" tabindex="-1" href="#编码方式" class="anchor"><span class="icon icon-link"></span></a>编码方式</h3>
        <p>采用不同编码方式来应对不同的场景，以达到高性能。</p>
        <p>包含了三种编码方式：</p>
        <ul>
          <li>INT：存放可以用long表示的整数</li>
          <li>EMBSTR：字符串小于等于阈值字节</li>
          <li>RAW：字符串大于阈值字节</li>
        </ul>
        <p>其中EMBSTR和RAW由redisObject和SDS（Simple Dynamic String）构成，EMBSTR下的redisObject和SDS是连续的内存，而RAW是离散的。</p>
        <ul>
          <li>EMBSTR有点在于可以一次性分配空间，毕竟是连续分布的，缺点是在修改后需要<strong>整体重新分配空间</strong>。</li>
          <li>因此EMBSTR在发生写操作后，会变成RAW，默认当作发生过修改的字符串通常是易变的。</li>
          <li>编码可能会发生转换
            <ul>
              <li>INT->RAW：当存的内容不再是整数，或者大小超过了long的时候。</li>
              <li>EMBSTR->RAW：任何写操作之后EMBSTR都会变成RAW,原因前面有解释。</li>
            </ul>
          </li>
        </ul>
        <h3 id="为什么使用sds"><a aria-hidden="true" tabindex="-1" href="#为什么使用sds" class="anchor"><span class="icon icon-link"></span></a>为什么使用SDS</h3>
        <ul>
          <li>SDS 不仅可以保存文本数据，还可以保存二进制数据。不再以<code>\'0'</code>作为判断标准，二进制安全</li>
          <li>SDS 获取字符串长度的时间复杂度是 O(1)：增加了len长度字段，原生C是O(n)</li>
          <li>Redis 的 SDS API 是安全的，拼接字符串不会造成缓冲区溢出：增加了空余空间（alloc - len)，有了预留空间，节约性能</li>
        </ul>
        <h2 id="list"><a aria-hidden="true" tabindex="-1" href="#list" class="anchor"><span class="icon icon-link"></span></a>List</h2>
      </markdown-style>
      <nav class="tocs">
        <aside class="inner toc">
          <ol class="tocs-list">
            <li><a href="#关键点" class="tocs-link">关键点</a></li>
            <li><a href="#对象" class="tocs-link">对象</a></li>
            <li><a href="#string" class="tocs-link">String</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#适用场景" class="tocs-link">适用场景</a></li>
                <li><a href="#使用" class="tocs-link">使用</a></li>
                <li><a href="#编码方式" class="tocs-link">编码方式</a></li>
                <li><a href="#为什么使用sds" class="tocs-link">为什么使用SDS</a></li>
              </ol>
            </li>
            <li><a href="#list" class="tocs-link">List</a></li>
          </ol>
        </aside>
      </nav>
    </div>
    <script src="../js/demo-preview.js?v=1.25.0"></script>
    <div class="footer warpper">Created by <a href="https://github.com/shixiaocaia" target="_blank">shixiaocaia</a> | Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a><br>Think less and do more.</div>
    <script src="../js/tocbot.js?v=1.25.0"></script>
  </body>
</html>
