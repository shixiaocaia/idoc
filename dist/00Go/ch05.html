<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gin iDoc</title>
    <meta name="description" content="Gin 是 Go 语言写的一个 web 框架，它具有运行速度快，分组的路由器，良好的崩溃捕获和错误处理，非常好的支持中间件和 json。总之在 Go 语言开发领域是一款值得好好研究的 Web 框架，开源网址：github.com/gin-g">
    <meta name="keywords" content="notebook">
    <link rel="stylesheet" type="text/css" href="../css/main.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/tocbot.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/media.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/sidebar.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/copy.css?v=1.25.0">
    <link rel="stylesheet" type="text/css" href="../css/fancybox.css?v=1.25.0">
    <link rel="icon" href="../logo.png" type="image/x-icon">
    <script src="../js/copy.js?v=1.25.0"></script>
    <script src="../js/dark-mode.js?v=1.25.0"></script>
    <script src="../js/markdown-style.js?v=1.25.0"></script>
    <script src="../js/jquery.min.js?v=1.25.0"></script>
    <script src="../js/fancybox.umd.js?v=1.25.0"></script>
  </head>
  <body><button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
    <script>
// Get the button:
let mybutton = document.getElementById("myBtn");
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};
// 顶部隐藏，底部隐藏
function scrollFunction() {
if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
mybutton.style.display = "block";
} else {
mybutton.style.display = "none";
}
}
// When the user clicks on the button, scroll to the top of the document
function topFunction() {
document.body.scrollTop = 0; // For Safari
document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
</script>
    <header class="header">
      <article class="inner warpper"><a class="logo" href="../index.html"><img alt="iDoc logo" src="../logo.png">
<span class="title">iDoc</span></a>
        <div class="content">
          <ul class="menu">
            <li><a href="../index.html" target="" class="">Home</a></li>
            <li><a href="index.html" target="" class="active">Go</a></li>
            <li><a href="../01MySQL/index.html" target="" class="">MySQL</a></li>
            <li><a href="../01Redis/index.html" target="" class="">Redis</a></li>
            <li><a href="../01LeetCode/index.html" target="" class="">LeetCode</a></li>
            <li><a href="../02HelloWorld/index.html" target="" class="">Hello World</a></li>
          </ul><a href="https://github.com/shixiaocaia" target="_blank" rel="noopener noreferrer" title="Github" name="Github" class="github"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg></a>
          <dark-mode permanent=""></dark-mode>
        </div>
      </article>
    </header>
    <div class="warpper-content warpper sidebar">
      <div class="sidebar-border">
        <aside class="sidebar" role="navigation">
          <div>
            <a href="index.html" class="">↩️README</a>
            <label>Hello World</label>
            <a href="ch00.html" class="">配个环境</a>
            <a href="ch04.html" class="">Go Moudle</a>
            <a href="ch01.html" class="">基础语法</a>
            <a href="ch02.html" class="">并发编程</a>
            <label>Web编程</label>
            <a href="ch03.html" class="">gorm</a>
            <a href="ch05.html" class="">gin</a>
            <label>原理深入</label>
            <a href="ch06.html" class="">原理分析</a>
          </div>
        </aside>
      </div>
      <markdown-style>
        <h1 id="gin"><a aria-hidden="true" tabindex="-1" href="#gin" class="anchor"><span class="icon icon-link"></span></a>Gin</h1>
        <p><a href="https://www.kancloud.cn/shuangdeyu/gin_book/949411">第三方中文文档</a></p>
        <h2 id="是什么"><a aria-hidden="true" tabindex="-1" href="#是什么" class="anchor"><span class="icon icon-link"></span></a>是什么</h2>
        <p>Gin 是 Go 语言写的一个 web 框架，它具有运行速度快，分组的路由器，良好的崩溃捕获和错误处理，非常好的支持中间件和 json。总之在 Go 语言开发领域是一款值得好好研究的 Web 框架，开源网址：github.com/gin-gonic/gin</p>
        <p>gin有如下特点：</p>
        <ul>
          <li>接入成本非常低，作为一个组件，这是最重要的一点</li>
          <li>拥有强大的中间件功能，用户可以自主定制需要的功能</li>
          <li>由于使用了radix树，路由的性能很高。</li>
          <li>数据绑定，让用户可以非常方便地从请求中获取想要的结构体。</li>
        </ul>
        <h3 id="运行模式"><a aria-hidden="true" tabindex="-1" href="#运行模式" class="anchor"><span class="icon icon-link"></span></a>运行模式</h3>
        <p>Gin框架提供了两种运行模式：<code>debug</code>（调试模式）和<code>release</code>（发布模式），用于控制框架的行为和日志输出级别。</p>
        <ol>
          <li><strong>调试模式（debug）</strong>：
            <ul>
              <li>在调试模式下，Gin框架将提供更详细的日志输出，方便开发人员进行调试和开发。</li>
              <li>在请求发生错误时，Gin框架将返回详细的错误信息和堆栈跟踪。</li>
              <li>Gin框架会自动重新编译和加载模板文件，以便在修改模板时无需重启应用程序。</li>
              <li>调试模式下，Gin框架会输出更多的调试信息，如请求和响应的详细信息、路由匹配信息等。</li>
            </ul>
          </li>
          <li><strong>发布模式（release）</strong>：
            <ul>
              <li>在发布模式下，Gin框架将提供更高的性能和更少的日志输出，适用于生产环境。</li>
              <li>发布模式下，Gin框架会限制详细的错误信息和堆栈跟踪的输出，以防止敏感信息泄露。</li>
              <li>Gin框架不会自动重新加载模板文件，以提高性能和减少IO操作。</li>
              <li>发布模式下，Gin框架会输出更简洁的日志信息，如请求和响应的基本信息，以减少日志输出量。</li>
            </ul>
          </li>
        </ol>
        <h2 id="run"><a aria-hidden="true" tabindex="-1" href="#run" class="anchor"><span class="icon icon-link"></span></a>Run</h2>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">go</span> get <span class="token operator">-</span>u github<span class="token punctuation">.</span>com<span class="token operator">/</span>gin<span class="token operator">-</span>gonic<span class="token operator">/</span>gin
</span></code><input type="hidden" value="go get -u github.com/gin-gonic/gin
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="get-post-put-delete"><a aria-hidden="true" tabindex="-1" href="#get-post-put-delete" class="anchor"><span class="icon icon-link"></span></a>GET POST PUT DELETE</h2>
        <h3 id="get--post获取参数"><a aria-hidden="true" tabindex="-1" href="#get--post获取参数" class="anchor"><span class="icon icon-link"></span></a>GET + POST获取参数</h3>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">	router<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/post"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6">		id <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="7">		page <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">DefaultQuery</span><span class="token punctuation">(</span><span class="token string">"page"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">		name <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">PostForm</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">		message <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">PostForm</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"id: %s; page: %s; name: %s; message: %s"</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> page<span class="token punctuation">,</span> name<span class="token punctuation">,</span> message<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="13">	router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="14"><span class="token punctuation">}</span>
</span></code><input type="hidden" value="func main() {
	router := gin.Default()

	router.POST(&#x22;/post&#x22;, func(c *gin.Context) {

		id := c.Query(&#x22;id&#x22;)
		page := c.DefaultQuery(&#x22;page&#x22;, &#x22;0&#x22;)
		name := c.PostForm(&#x22;name&#x22;)
		message := c.PostForm(&#x22;message&#x22;)

		fmt.Printf(&#x22;id: %s; page: %s; name: %s; message: %s&#x22;, id, page, name, message)
	})
	router.Run(&#x22;:8080&#x22;)
}
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ul>
          <li>
            <p>GET在后缀中<code>/post?id=1234&#x26;page=1 HTTP/1.1</code>，通过<code>Query</code>获取</p>
          </li>
          <li>
            <p>POST在BODY中的form_data中设置，通过<code>postman</code>获取</p>
          </li>
        </ul>
        <h2 id="模型绑定和验证"><a aria-hidden="true" tabindex="-1" href="#模型绑定和验证" class="anchor"><span class="icon icon-link"></span></a>模型绑定和验证</h2>
        <ul>
          <li>若要将请求主体绑定到结构体中，请使用模型绑定，目前支持JSON、XML、YAML和标准表单值(foo=bar&#x26;boo=baz)的绑定</li>
          <li>需要在绑定的字段上设置tag，比如，绑定格式为json，需要这样设置 <code>json:"fieldname"</code>
            <ul>
              <li>常使用json，uri</li>
              <li>如果一个字段用<code>binding:"required"</code>修饰，并且在绑定时该字段的值为空，那么将返回一个错误。</li>
            </ul>
          </li>
          <li>一般使用ShouldBind</li>
          <li>可以自定义验证器</li>
        </ul>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">mustBig</span><span class="token punctuation">(</span>f1 validator<span class="token punctuation">.</span>FieldLevel<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Interface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="3">	<span class="token keyword">return</span> <span class="token boolean">true</span>
</span><span class="code-line line-number" line="4"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token keyword">if</span> v<span class="token punctuation">,</span> ok <span class="token operator">:=</span> binding<span class="token punctuation">.</span>Validator<span class="token punctuation">.</span><span class="token function">Engine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>validator<span class="token punctuation">.</span>Validate<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">    v<span class="token punctuation">.</span><span class="token function">RegisterValidation</span><span class="token punctuation">(</span><span class="token string">"mustBig"</span><span class="token punctuation">,</span> mustBig<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code><input type="hidden" value="func mustBig(f1 validator.FieldLevel) bool {
	fmt.Println(f1.Field().Interface().(int))
	return true
}

if v, ok := binding.Validator.Engine().(*validator.Validate); ok {
    v.RegisterValidation(&#x22;mustBig&#x22;, mustBig)
}
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ul>
          <li><code>ShouldBindQuery</code> 函数只绑定Get参数，不绑定post数据</li>
          <li><code>ShouldBind</code>如果是GET请求会绑定查询字符串中的参数，
            <ul>
              <li>如果是POST请求，优先绑定form表单或Json字符串中的数据，如果没有也可以绑定查询字符串中的数据</li>
            </ul>
          </li>
        </ul>
        <h2 id="文件接受和返回"><a aria-hidden="true" tabindex="-1" href="#文件接受和返回" class="anchor"><span class="icon icon-link"></span></a>文件接受和返回</h2>
        <ul>
          <li>gin中的saveupFile实际是本地先读取，再拷贝到创建的文件当中</li>
        </ul>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//携带中间件启动</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">	r<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/testUpload"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">		file<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">FormFile</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6">		<span class="token comment">//c.SaveUploadedFile(file, "./"+file.Filename)</span>
</span><span class="code-line line-number" line="7">		in<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> file<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">		<span class="token keyword">defer</span> in<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">		out<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"./"</span> <span class="token operator">+</span> file<span class="token punctuation">.</span>Filename<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">		<span class="token keyword">defer</span> out<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="11">		io<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> in<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">			<span class="token string">"msg"</span><span class="token punctuation">:</span> file<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="14">		<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="15">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="16">
</span><span class="code-line line-number" line="17">	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span> <span class="token comment">// listen and serve on 0.0.0.0:8080</span>
</span><span class="code-line line-number" line="18"><span class="token punctuation">}</span>
</span></code><input type="hidden" value="func main() {
	r := gin.Default() //携带中间件启动

	r.POST(&#x22;/testUpload&#x22;, func(c *gin.Context) {
		file, _ := c.FormFile(&#x22;file&#x22;)
		//c.SaveUploadedFile(file, &#x22;./&#x22;+file.Filename)
		in, _ := file.Open()
		defer in.Close()
		out, _ := os.Create(&#x22;./&#x22; + file.Filename)
		defer out.Close()
		io.Copy(out, in)
		c.JSON(200, gin.H{
			&#x22;msg&#x22;: file,
		})
	})

	r.Run(&#x22;:8080&#x22;) // listen and serve on 0.0.0.0:8080
}
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ul>
          <li>不论是多文件上传还是单文件上传，获取<code>form.File["file"]</code>中的<code>file</code>名称只需要与前端HTML表单中的文件上传字段名称保持一致。</li>
        </ul>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="3">	<span class="token comment">// 给表单限制上传大小 (默认 32 MiB)</span>
</span><span class="code-line line-number" line="4">	<span class="token comment">// router.MaxMultipartMemory = 8 &#x3C;&#x3C; 20  // 8 MiB</span>
</span><span class="code-line line-number" line="5">	router<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/testUpload"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">		<span class="token comment">// 多文件</span>
</span><span class="code-line line-number" line="7">		form<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">MultipartForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">		files <span class="token operator">:=</span> form<span class="token punctuation">.</span>File<span class="token punctuation">[</span><span class="token string">"upload"</span><span class="token punctuation">]</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10">		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> file <span class="token operator">:=</span> <span class="token keyword">range</span> files <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">			log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>Filename<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">
</span><span class="code-line line-number" line="13">			<span class="token comment">// 上传文件到指定的路径</span>
</span><span class="code-line line-number" line="14">			<span class="token comment">// c.SaveUploadedFile(file, file.Filename)</span>
</span><span class="code-line line-number" line="15">		<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="16">		c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d files uploaded!"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="17">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="18">	router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="19"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="20">
</span></code><input type="hidden" value="func main() {
	router := gin.Default()
	// 给表单限制上传大小 (默认 32 MiB)
	// router.MaxMultipartMemory = 8 << 20  // 8 MiB
	router.POST(&#x22;/testUpload&#x22;, func(c *gin.Context) {
		// 多文件
		form, _ := c.MultipartForm()
		files := form.File[&#x22;upload&#x22;]

		for _, file := range files {
			log.Println(file.Filename)

			// 上传文件到指定的路径
			// c.SaveUploadedFile(file, file.Filename)
		}
		c.String(http.StatusOK, fmt.Sprintf(&#x22;%d files uploaded!&#x22;, len(files)))
	})
	router.Run(&#x22;:8080&#x22;)
}

"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="中间件和路由分组"><a aria-hidden="true" tabindex="-1" href="#中间件和路由分组" class="anchor"><span class="icon icon-link"></span></a>中间件和路由分组</h2>
        <p>对router创建group就是分组，同一分组就会有同一前缀和中间件。</p>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//携带中间件启动, 基础路由器</span>
</span><span class="code-line line-number" line="3">	<span class="token comment">//v1 := r.Group("v1")</span>
</span><span class="code-line line-number" line="4">	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"我在分组方法内"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6">		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">			<span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">		<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span> <span class="token comment">// listen and serve on 0.0.0.0:8080</span>
</span><span class="code-line line-number" line="12"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="13">
</span></code><input type="hidden" value="func main() {
	r := gin.Default() //携带中间件启动, 基础路由器
	//v1 := r.Group(&#x22;v1&#x22;)
	r.GET(&#x22;test&#x22;, func(c *gin.Context) {
		fmt.Println(&#x22;我在分组方法内&#x22;)
		c.JSON(200, gin.H{
			&#x22;success&#x22;: true,
		})
	})

	r.Run(&#x22;:8080&#x22;) // listen and serve on 0.0.0.0:8080
}

"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <ul>
          <li>区别加了分组v1和直接对r发起GET请求</li>
        </ul>
        <h3 id="为什么分组"><a aria-hidden="true" tabindex="-1" href="#为什么分组" class="anchor"><span class="icon icon-link"></span></a>为什么分组</h3>
        <ul>
          <li>结构更加清晰</li>
          <li>方便管理路由
            <ul>
              <li>专属的中间件</li>
            </ul>
          </li>
        </ul>
        <blockquote>
          <p><strong>什么是中间件</strong></p>
          <p>在请求到达路由方法<strong>前后</strong>的一些列操作</p>
        </blockquote>
        <ul>
          <li>执行的顺序是一种洋葱中间件的形式
            <ul>
              <li>1-1</li>
              <li>2-1</li>
              <li>3</li>
              <li>2-2</li>
              <li>1-2</li>
            </ul>
          </li>
        </ul>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">middle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"我在方法1前"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="4">		c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 是否往下走, 洋葱中间件</span>
</span><span class="code-line line-number" line="5">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"我在方法1后"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="6">	<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token keyword">func</span> <span class="token function">middle2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> gin<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="10">	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"我在方法2前"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">		c<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 是否往下走, 洋葱中间件</span>
</span><span class="code-line line-number" line="13">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"我在方法2后"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="14">	<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="15"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="16">
</span><span class="code-line line-number" line="17"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="18">	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//携带中间件启动, 基础路由器</span>
</span><span class="code-line line-number" line="19">	v1 <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"v1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token function">middle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">middle2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="20">	v1<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="21">		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"我在分组方法内"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="22">		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
</span><span class="code-line line-number" line="23">			<span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="24">		<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="25">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="26">
</span><span class="code-line line-number" line="27">	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span> <span class="token comment">// listen and serve on 0.0.0.0:8080</span>
</span><span class="code-line line-number" line="28"><span class="token punctuation">}</span>
</span></code><input type="hidden" value="func middle() gin.HandlerFunc {
	return func(c *gin.Context) {
		fmt.Println(&#x22;我在方法1前&#x22;)
		c.Next() // 是否往下走, 洋葱中间件
		fmt.Println(&#x22;我在方法1后&#x22;)
	}
}

func middle2() gin.HandlerFunc {
	return func(c *gin.Context) {
		fmt.Println(&#x22;我在方法2前&#x22;)
		c.Next() // 是否往下走, 洋葱中间件
		fmt.Println(&#x22;我在方法2后&#x22;)
	}
}

func main() {
	r := gin.Default() //携带中间件启动, 基础路由器
	v1 := r.Group(&#x22;v1&#x22;).Use(middle(), middle2())
	v1.GET(&#x22;test&#x22;, func(c *gin.Context) {
		fmt.Println(&#x22;我在分组方法内&#x22;)
		c.JSON(200, gin.H{
			&#x22;success&#x22;: true,
		})
	})

	r.Run(&#x22;:8080&#x22;) // listen and serve on 0.0.0.0:8080
}
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h3 id="中间件"><a aria-hidden="true" tabindex="-1" href="#中间件" class="anchor"><span class="icon icon-link"></span></a>中间件</h3>
        <pre class="language-go"><code class="language-go code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 默认启动方式，包含了Logger、 Recovery中间件</span>
</span><span class="code-line line-number" line="3">    
</span><span class="code-line line-number" line="4">    
</span><span class="code-line line-number" line="5">    <span class="token comment">// 新建一个没有任何默认中间件的路由</span>
</span><span class="code-line line-number" line="6">    r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">    <span class="token comment">// 全局中间件</span>
</span><span class="code-line line-number" line="9">    <span class="token comment">// Logger 中间件将日志写入 gin.DefaultWriter，即使你将 GIN_MODE 设置为 release。</span>
</span><span class="code-line line-number" line="10">    <span class="token comment">// By default gin.DefaultWriter = os.Stdout</span>
</span><span class="code-line line-number" line="11">    r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>gin<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">
</span><span class="code-line line-number" line="13">    <span class="token comment">// Recovery 中间件会 recover 任何 panic。如果有 panic 的话，会写入 500。</span>
</span><span class="code-line line-number" line="14">    r<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>gin<span class="token punctuation">.</span><span class="token function">Recovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16">    <span class="token comment">// 你可以为每个路由添加任意数量的中间件。</span>
</span><span class="code-line line-number" line="17">    r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/benchmark"</span><span class="token punctuation">,</span> <span class="token function">MyBenchLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> benchEndpoint<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="18">
</span><span class="code-line line-number" line="19">    <span class="token comment">// 认证路由组</span>
</span><span class="code-line line-number" line="20">    <span class="token comment">// authorized := r.Group("/", AuthRequired())</span>
</span><span class="code-line line-number" line="21">    <span class="token comment">// 和使用以下两行代码的效果完全一样:</span>
</span><span class="code-line line-number" line="22">    authorized <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="23">    <span class="token comment">// 路由组中间件! 在此例中，我们在 "authorized" 路由组中使用自定义创建的 </span>
</span><span class="code-line line-number" line="24">    <span class="token comment">// AuthRequired() 中间件</span>
</span><span class="code-line line-number" line="25">    authorized<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span><span class="token function">AuthRequired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="26">    <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="27">        authorized<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> loginEndpoint<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="28">        authorized<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/submit"</span><span class="token punctuation">,</span> submitEndpoint<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="29">        authorized<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/read"</span><span class="token punctuation">,</span> readEndpoint<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="30">
</span><span class="code-line line-number" line="31">        <span class="token comment">// 嵌套路由组</span>
</span><span class="code-line line-number" line="32">        testing <span class="token operator">:=</span> authorized<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"testing"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="33">        testing<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/analytics"</span><span class="token punctuation">,</span> analyticsEndpoint<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="34">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="35">
</span><span class="code-line line-number" line="36">    <span class="token comment">// 监听并在 0.0.0.0:8080 上启动服务</span>
</span><span class="code-line line-number" line="37">    r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="38"><span class="token punctuation">}</span>
</span></code><input type="hidden" value="func main() {
    r := gin.Default() // 默认启动方式，包含了Logger、 Recovery中间件
    
    
    // 新建一个没有任何默认中间件的路由
    r := gin.New()

    // 全局中间件
    // Logger 中间件将日志写入 gin.DefaultWriter，即使你将 GIN_MODE 设置为 release。
    // By default gin.DefaultWriter = os.Stdout
    r.Use(gin.Logger())

    // Recovery 中间件会 recover 任何 panic。如果有 panic 的话，会写入 500。
    r.Use(gin.Recovery())

    // 你可以为每个路由添加任意数量的中间件。
    r.GET(&#x22;/benchmark&#x22;, MyBenchLogger(), benchEndpoint)

    // 认证路由组
    // authorized := r.Group(&#x22;/&#x22;, AuthRequired())
    // 和使用以下两行代码的效果完全一样:
    authorized := r.Group(&#x22;/&#x22;)
    // 路由组中间件! 在此例中，我们在 &#x22;authorized&#x22; 路由组中使用自定义创建的 
    // AuthRequired() 中间件
    authorized.Use(AuthRequired())
    {
        authorized.POST(&#x22;/login&#x22;, loginEndpoint)
        authorized.POST(&#x22;/submit&#x22;, submitEndpoint)
        authorized.POST(&#x22;/read&#x22;, readEndpoint)

        // 嵌套路由组
        testing := authorized.Group(&#x22;testing&#x22;)
        testing.GET(&#x22;/analytics&#x22;, analyticsEndpoint)
    }

    // 监听并在 0.0.0.0:8080 上启动服务
    r.Run(&#x22;:8080&#x22;)
}
"><div onclick="copied(this)" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
        <h2 id="日志以及日志格式"><a aria-hidden="true" tabindex="-1" href="#日志以及日志格式" class="anchor"><span class="icon icon-link"></span></a>日志以及日志格式</h2>
        <h3 id="有什么用"><a aria-hidden="true" tabindex="-1" href="#有什么用" class="anchor"><span class="icon icon-link"></span></a>有什么用</h3>
        <ul>
          <li>记录参数信息</li>
          <li>猜测用户行为</li>
          <li>复现系统bug并修复</li>
        </ul>
        <h3 id="怎么用"><a aria-hidden="true" tabindex="-1" href="#怎么用" class="anchor"><span class="icon icon-link"></span></a>怎么用</h3>
        <ul>
          <li>默认日志文件打印在控制台</li>
          <li>建议自定义日志格式</li>
          <li>第三方日志中工具
            <ul>
              <li>logrus</li>
              <li>go-logging</li>
            </ul>
          </li>
          <li>日志切割
            <ul>
              <li>自行根据时间在写入时判断进行切割日志</li>
              <li>借助成品的日志包：go-file-rotatelogs / file-rotatelogs</li>
            </ul>
          </li>
          <li>一般在中间件当中使用</li>
        </ul>
        <h2 id="使用gorm操作数据库"><a aria-hidden="true" tabindex="-1" href="#使用gorm操作数据库" class="anchor"><span class="icon icon-link"></span></a>使用GORM操作数据库</h2>
      </markdown-style>
      <nav class="tocs">
        <aside class="inner toc">
          <ol class="tocs-list">
            <li><a href="#是什么" class="tocs-link">是什么</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#运行模式" class="tocs-link">运行模式</a></li>
              </ol>
            </li>
            <li><a href="#run" class="tocs-link">Run</a></li>
            <li><a href="#get-post-put-delete" class="tocs-link">GET POST PUT DELETE</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#get--post获取参数" class="tocs-link">GET + POST获取参数</a></li>
              </ol>
            </li>
            <li><a href="#模型绑定和验证" class="tocs-link">模型绑定和验证</a></li>
            <li><a href="#文件接受和返回" class="tocs-link">文件接受和返回</a></li>
            <li><a href="#中间件和路由分组" class="tocs-link">中间件和路由分组</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#为什么分组" class="tocs-link">为什么分组</a></li>
                <li><a href="#中间件" class="tocs-link">中间件</a></li>
              </ol>
            </li>
            <li><a href="#日志以及日志格式" class="tocs-link">日志以及日志格式</a>
              <ol class="tocs-list is-collapsed">
                <li><a href="#有什么用" class="tocs-link">有什么用</a></li>
                <li><a href="#怎么用" class="tocs-link">怎么用</a></li>
              </ol>
            </li>
            <li><a href="#使用gorm操作数据库" class="tocs-link">使用GORM操作数据库</a></li>
          </ol>
        </aside>
      </nav>
    </div>
    <script src="../js/demo-preview.js?v=1.25.0"></script>
    <div class="footer warpper">Created by <a href="https://github.com/shixiaocaia" target="_blank">shixiaocaia</a> | Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a><br>Think less and do more.</div>
    <script src="../js/tocbot.js?v=1.25.0"></script>
  </body>
</html>
