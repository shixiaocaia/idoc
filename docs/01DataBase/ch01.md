向前一步
===
## 创建计算字段

字段（field）基本上与列（column）的意思相同，字段通常用在计算字段的连接上。

> 只有数据库知道SELECT语句中哪些列是实际的 表列，哪些列是计算字段。从客户机（如应用程序）的角度来看，计算字段的数据是以与其他列的数据相同的方式返回的。

### 拼接字段

```sql
 select concat(city,' ',address) from student;         
```

`RTrim`和`LTrim`处理所选列的左右空格。

### 使用别名

```sql
 select concat(city,' ',RTrim(address)) as newtitle from student;
```

`as`给拼接字段的列起一个新的名字。

### 算数运算

```sql
select name,price*nums as sum from fruits;
```

MySQL支持基本的加减乘除运算。

## 使用数据处理函数

### 文本处理函数

```sql
 select concat(city,' ',RTrim(address)) as newtitle from student;
 # RTrim /  LTrim() 去除空格
 
 select city, upper(address) as newaddress from student;
 # Upper() / Lower()文本大小写转换
 
 Left() /  Right()
 # 返回串左边 / 右边的字符
 
 Length()
 # 返回串的长度
 
 Locate()
 # 找出串的一个字串
 
 Soundex()
 # 返回串的SOUNDEX值
 # 将任何文本串转换为描述其语音表示的字母数字模式的算法
 
 SubString()
 # 返回子串的字符
```

### 日期和时间处理函数

```sql
AddDate()     增加一个日期（天、周等）
AddTime()     增加一个时间（时、分等）
CurDate()     返回当前日期
CurTime()     返回当前时间
Date()        返回日期时间的日期部分
DateDiff()    计算两个日期之差
Date_Add()    高度灵活的日期运算函数
Date_Format() 返回一个格式化的日期或时间串
Day()         返回一个日期的天数部分
Dayofweek()   对于一个日期，返回对应的星期几
Hour()        返回一个时间的小时部分
Minute()      返回一个时间的分钟部分
Month()       返回一个日期的月份部分
NowC()        返回当前日期和时间
Second()      返回一个时间的秒部分
Time()        返回一个日期时间的时间部分
Year()        返回一个日期的年份部分
```

> 对于datatime的数据类型存储日期以及时间值，样例表中的值全具有时间值`00::00::00`，当我们直接使用`where order_date = '2005-09-01';`，与实际存储的`where order_data = '2005-09-01 11::30::14`冲突，应该用`where date(order_date) = '2005-09-01'`。

```sql
where date(order_date) between '2005-09-01' and '2005-10-01';
```

### 数值处理函数

```sql
Abs()  返回一个数的绝对值
Cos()  返回一个角度的余弦
Exp()  返回一个数的指数值
Mod()  返回除操作的余数
Pi()   返回圆周率
Rand() 返回一个随机数
Sin()  返回一个角度的正弦
Sqrt() 返回一个数的平方根
Tan()  返回一个角度的正切
```

## 汇总数据

### 聚集函数

运行在行组上，计算和返回单个值得函数。

```sql
select AVG(id) as avg_id from student;
select AVG(id) as avg_id from student where city = '杭州';
```

> AVG函数只能计算特定列的平均值，并且会忽略值为NULL的行。

```sql
select count(*) as count_id from student;
select count(city) from student;
```

> COUNT函数针对特定列有值的进行行的计数，会忽略对应列为NULL的行。

```sql
select max(id) from student;
select min(id) from student;
```

> 如果有多行结果时，返回最后一行的，MAX也会忽略NULL的行。
>
> MIN返回最前面的行。

```sql
select sum(id) from student;
```

### 聚合不同的值

```sql
select AVG(distinct id) as id_avg from student;
```

> 默认是ALL，不需要指定。
>
> 使用DISTINCT参数，会考虑不同的数值大小。

### 组合聚集函数

```sql
select AVG(id) as id_avg,count(id) as num from student;
```

> 注意逗号分割。
