什么都有
===
## 键入网址到网页显示，期间发生了什么？
### HTTP

浏览器做的第一步工作是**解析 URL**

> `https://xiaolincoding.com/network/1_.html`
>
> 1. https表示访问的数据的协议
> 2. xiaolincoding.com服务器名称
> 3. 后续是文件的路径名，当省略路径名时访问默认网页，一般是index.html

确定完服务器名和文件名后，根据信息生成HTTP请求报文。

### DNS

在发送前，要查询对应的IP地址。

详情去看**域名解析流程**。

### 协议栈

通过 DNS 获取到 IP 后，就可以把 HTTP 的传输工作交给操作系统中的**协议栈**。

![img](http://pic.shixiaocaia.fun/202302191215859.png)

### TCP

了解TCP其中的报文信息。

三次握手，四次挥手。

### IP

TCP 模块在执行连接、收发、断开等各阶段操作时，都需要委托 IP 模块将数据封装成**网络包**发送给通信对象。

### MAC

TCP报文套上IP报文头后，又加上MAC地址。

### 出口-网卡

网卡将网络包转为电信号，通过网线发送出去。



### 送别者-交换机

将网络包原样转发到目的地。交换机工作在MAC层，也称为二层网络设备。

首先，电信号到达网线接口，交换机里的模块进行接收，接下来交换机里的模块将电信号转换为数字信号。

然后通过包末尾的 `FCS` 校验错误，如果没问题则放到缓冲区。这部分操作基本和计算机的网卡相同，但交换机的工作方式和网卡不同。

计算机的网卡本身具有 MAC 地址，并通过核对收到的包的接收方 MAC 地址判断是不是发给自己的，如果不是发给自己的则丢弃；相对地，交换机的端口不核对接收方 MAC 地址，而是直接接收所有的包并存放到缓冲区中。因此，和网卡不同，**交换机的端口不具有 MAC 地址**。

将包存入缓冲区后，接下来需要查询一下这个包的接收方 MAC 地址是否已经在 MAC 地址表中有记录了。

交换机的 MAC 地址表主要包含两个信息：

- 一个是设备的 MAC 地址，
- 另一个是该设备连接在交换机的哪个端口上。

**交换机根据 MAC 地址表查找 MAC 地址，然后将信号发送到相应的端口**。

> 交换机中的MAC地址与网线端口的映射表是怎么获取的。

> 如果当 MAC 地址表找不到指定的 MAC 地址会怎么样？

> 交换机的作用

### 出境大门-路由器

> 路由器与交换机的区别

网络包经过交换机之后，现在到达了**路由器**，并在此被转发到下一个路由器或目标设备。

这一步转发的工作原理和交换机类似，也是通过查表判断包转发的目标。

不过在具体的操作过程上，路由器和交换机是有区别的。

- 因为**路由器**是基于 IP 设计的，俗称**三层**网络设备，路由器的各个端口都具有 MAC 地址和 IP 地址；
- 而**交换机**是基于以太网设计的，俗称**二层**网络设备，交换机的端口不具有 MAC 地址。

> 路由器解析包开头的MAC头部，MAC 头部的作用就是将包送达路由器，其中的接收方 MAC 地址就是路由器端口的 MAC 地址。
>
> 因此，当包到达路由器之后，MAC 头部的任务就完成了，于是 MAC 头部就会**被丢弃**。
>
> 接下来，路由器会根据 MAC 头部后方的 `IP` 头部中的内容进行包的转发操作。

### 服务器端

数据包抵达服务器后，服务器会先扒开数据包的 MAC 头部，查看是否和服务器自己的 MAC 地址符合，符合就将包收起来。

接着解析报文。
