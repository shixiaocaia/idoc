IP知识全家桶
===

## IP的基本认识

IP 在 TCP/IP 参考模型中处于第三层，也就是*网络层*。

网络层的主要作用是：实现主机与主机之间的通信，也叫*点对点（end to end）通信*。

> 网络层与数据链路层有什么关系呢？
>
> - IP(网络层)用于实现主机与主机之间的通信
>
> - MAC(数据链路层)实现「直连」的两个设备之间通信。

在网络中数据包传输中也是如此，源IP地址和目标IP地址在传输过程中是不会变化的（前提：没有使用 NAT 网络），只有源 MAC 地址和目标 MAC 一直在变化。

## IP地址的基础知识

在 TCP/IP 网络通信时，为了保证能正常通信，每个设备都需要配置正确的 IP 地址，否则无法实现正常的通信。

IP 地址（IPv4 地址）由 `32` 位正整数来表示，IP 地址在计算机是以二进制的方式处理的。

而人类为了方便记忆采用了**点分十进制**的标记方式，也就是将 32 位 IP 地址以每 8 位为组，共分为 `4` 组，每组以「`.`」隔开，再将每组转换成十进制。

理论上32位的IP地址只能够大约43亿计算机连接网络，但是实际中不是这样分配的，实际中是根据**网卡**分配IP地址。

### IP地址分类

#### ABCDE

最早IP 地址分类成了 5 种类型，分别是 A 类、B 类、C 类、D 类、E 类。

每个地址划分为网络号和地址号两部分。

> 网络号：负责标识该 IP 地址是属于哪个「子网」的；
>
> 主机号：负责标识同一「子网」下的不同主机，用来区分设备。

![](http://pic.shixiaocaia.fun/202301301043432.png)

每一类地址的最大主机数是根据主机号位数再减去(主机号)全0和全1的网络地址和广播地址。

> 广播地址用于在同一个链路中相互连接的主机之间发送数据包。
>
> 本地广播（本网络内）：网络地址为 192.168.0.0/24 向192.168.0.255/24
>
> 直接广播（跨网络）：网络地址为 192.168.0.0/24 向192.168.1.255/24

而 D 类和 E 类地址是没有主机号的，所以不可用于主机 IP，D 类常被用于**多播**，E 类是预留的分类，暂时未使用。

> 多播用于将包发送给特定组内的所有主机。

由于广播无法穿透路由，若想给其他网段发送同样的包，就可以使用可以穿透路由的多播。

> 1. IP分类后，有利于更快找到网络地址和主机地址。
> 2. 上述ABCDE分类后，在同一网络下不利于继续分类，缺少地址的灵活性，不同类的地址数量不能很好的适应地址需求。

#### 无分类地址地址 CIDR

这种方式不再有分类地址的概念，32 比特的 IP 地址被划分为两部分，前面是**网络号**，后面是**主机号**。

将子网掩码和 IP 地址按位计算 AND，就可得到网络号。

> 通过前面的网络号判断计算机是否在一个处于同一个广播域内，即网络地址是否相同。如果网络地址相同，表明接受方在本网络上，那么可以把数据包直接发送到目标主机。
>
> 路由器也是经过网络号来匹配转发到对应子网中。

通过子网掩码可以对子网在进行划分，对主机号进行划分使用。比如可以借两位主机号，从而将子网划分为四个段。

#### 公有IP地址和私有IP地址

往往我们在学校是使用的是私有IP地址，当我们访问网络时，网站看到是一个公网IP地址。

私有 IP 地址通常是内部的 IT 人员管理，公有 IP 地址是由 `ICANN` 组织管理，中文叫「互联网名称与数字地址分配机构」。

> IPV4地址仍在使用的原因
>
> 通过将网络分为广域网和局域网来表示更多的主机设备。
>
> - 同一个局域网内的设备对外使用同一个IP，称为公网IP，在局域网内部的设备IP地址通过路由器进行分配。
> - 此外，局域网内还能嵌套局域网，从而表示更多的主机设备。
> - 根据需要不同的公网IP数量，在选择合适的ABC类IP地址进行划分，常见的使用C类，那么IP地址的开头就是192.168开头。
>
> 由此，IPv4地址到现如今还在继续使用。
